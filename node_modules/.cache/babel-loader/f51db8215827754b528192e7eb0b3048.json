{"ast":null,"code":"import { onMounted, ref } from \"vue\";\nimport { dragscroll } from 'vue-dragscroll';\nexport default {\n  name: 'MindMap',\n  props: {},\n  directives: {\n    dragscroll\n  },\n\n  setup() {\n    let title = ref(\"title\");\n    let nodes = ref([{\n      \"id\": 1,\n      'text': 'ch1',\n      'url': '',\n      'parent': 0,\n      'direction': ''\n    }, {\n      \"id\": 2,\n      'text': 'ch2',\n      'url': '',\n      'parent': 0,\n      'direction': ''\n    }, {\n      \"id\": 3,\n      'text': 'ch3',\n      'url': '',\n      'parent': 1,\n      'direction': ''\n    }, {\n      \"id\": 4,\n      'text': 'ch4',\n      'url': '',\n      'parent': 1,\n      'direction': ''\n    }, {\n      \"id\": 5,\n      'text': 'ch5',\n      'url': '',\n      'parent': 2,\n      'direction': ''\n    }, {\n      \"id\": 6,\n      'text': 'ch6',\n      'url': '',\n      'parent': 2,\n      'direction': ''\n    }, {\n      \"id\": 7,\n      'text': 'ch7',\n      'url': '',\n      'parent': 0,\n      'direction': ''\n    }, {\n      \"id\": 8,\n      'text': 'ch8',\n      'url': '',\n      'parent': 0,\n      'direction': ''\n    }]);\n    let lines = ref([]);\n    let count = 0;\n    const LeaderLine = window.LeaderLine; // 9/27 fix input and move node\n\n    const makeFromParent = (d, el, node_text, rap_node, node_childes, text) => {\n      node_text.classList.add(\"p_nodes\");\n      rap_node.classList.add(\"rap_node\");\n      node_childes.classList.add(\"node_childes\");\n      node_childes.id = `${el[\"id\"]}`;\n      node_text.id = `${\"node\" + el[\"id\"]}`;\n      node_text.appendChild(text);\n      count++;\n      return [rap_node, node_text, node_childes];\n    };\n\n    const makeFromChild = (el, node_text, rap_node, node_childes, text) => {\n      // console.log(\"child\", el)\n      const parent = document.getElementById(`${el[\"parent\"]}`);\n      console.log(parent);\n      node_text.classList.add(\"c_nodes\");\n      rap_node.classList.add(\"rap_node\");\n      node_childes.id = `${el[\"id\"]}`;\n      node_text.id = `${\"node\" + el[\"id\"]}`;\n      node_childes.classList.add(\"node_childes\");\n      node_text.appendChild(text);\n      rap_node.appendChild(node_childes);\n      rap_node.appendChild(node_text);\n      parent.appendChild(rap_node);\n      return node_childes;\n    };\n\n    const makelines = () => {\n      nodes.value.forEach(el => {\n        if (el.parent == 0) {\n          let line = new LeaderLine(document.getElementById('0'), LeaderLine.pointAnchor(document.getElementById(`${\"node\" + el[\"id\"]}`), {\n            x: '20%',\n            y: '50%'\n          })); // line.setOptions({startSocket: 'auto', endSocket: 'auto'});\n\n          line.path = \"magnet\";\n          line.endPlug = \"behind\";\n          lines.value.push(line);\n        } else {\n          let line = new LeaderLine(document.getElementById(`${\"node\" + el[\"parent\"]}`), LeaderLine.pointAnchor(document.getElementById(`${\"node\" + el[\"id\"]}`), {\n            x: '20%',\n            y: '50%'\n          }));\n          line.path = \"magnet\";\n          line.endPlug = \"behind\";\n          lines.value.push(line);\n        }\n      });\n    };\n\n    const removelines = () => {\n      lines.value.forEach(el => {\n        el.remove();\n      });\n      lines.value.length = 0;\n    };\n\n    const line_reset = () => {\n      removelines();\n      makelines();\n    };\n\n    const input_title = e => {\n      // console.log(e.srcElement.innerText)\n      title.value = e.srcElement.innerText;\n      console.log(title);\n      line_reset();\n    };\n\n    const keydown_node = e => {\n      // console.log(e)\n      e; // console.log(e.srcElement.innerText)\n      // console.log('before',e.target.offsetWidth)\n      // 横幅を動的に変更する\n\n      line_reset();\n    };\n\n    const keyup_node = e => {\n      // console.log('after',e.target.offsetWidth)\n      let id = Number(e.srcElement.id.replace(\"node\", \"\")); // console.log(e.srcElement.innerText)\n      // console.log(nodes.value[id - 1].text)\n\n      nodes.value[id - 1].text = e.srcElement.innerText;\n      console.log();\n      line_reset();\n    };\n\n    onMounted(() => {\n      console.log(\"mounted\");\n      document.getElementById('0').scrollIntoView({\n        block: 'center',\n        inline: 'center'\n      });\n      const right = document.getElementById(\"right_center\");\n      const left = document.getElementById(\"left_center\");\n      nodes.value.forEach(el => {\n        const node_text = document.createElement(\"div\");\n        const rap_node = document.createElement(\"div\");\n        const node_childes = document.createElement(\"div\");\n        const text = document.createTextNode(el[\"text\"]);\n        node_text.contentEditable = true;\n\n        if (el[\"parent\"] == 0) {\n          console.log();\n\n          if (count % 2 == 0) {\n            let nodeFromParent = makeFromParent(right, el, node_text, rap_node, node_childes, text);\n            nodeFromParent[0].appendChild(nodeFromParent[1]);\n            nodeFromParent[0].appendChild(nodeFromParent[2]);\n            right.appendChild(nodeFromParent[0]);\n            console.log('el', el.direction);\n            el.direction = 'right';\n          } else {\n            let nodeFromParent = makeFromParent(right, el, node_text, rap_node, node_childes, text);\n            nodeFromParent[0].appendChild(nodeFromParent[2]);\n            nodeFromParent[0].appendChild(nodeFromParent[1]);\n            left.appendChild(nodeFromParent[0]);\n            node_childes.classList.add(\"margin-auto\");\n            el.direction = 'left';\n          }\n        } else {\n          let child_node = makeFromChild(el, node_text, rap_node, node_childes, text);\n          console.log(\"child_node!!!!!!!!!!\", el);\n          console.log(nodes.value[el.parent - 1].direction);\n          el.direction = nodes.value[el.parent - 1].direction;\n\n          if (el.direction == 'right') {\n            child_node.classList.add(\"right_node_childes\");\n          } else {\n            child_node.classList.add(\"left_node_childes\");\n          }\n        } // console.log(nodes.value)\n        // if (count % 2 == 0) {\n        //   if (el[\"parent\"] == 0) {\n        //     let nodeFromParent = makeFromParent(right, el, node_text, rap_node, node_childes, text)\n        //     nodeFromParent[0].appendChild(nodeFromParent[1])\n        //     nodeFromParent[0].appendChild(nodeFromParent[2])\n        //     right.appendChild(nodeFromParent[0])\n        //   } else {\n        //     let child_node = makeFromChild(el, node_text, rap_node, node_childes, text)\n        //     child_node.classList.add(\"node_childes\")\n        //     console.log(\"child_node!!!!!!!!!!\", child_node)\n        //   }\n        // } else {\n        //   if (el[\"parent\"] == 0) {\n        //     let nodeFromParent = makeFromParent(right, el, node_text, rap_node, node_childes, text)\n        //     nodeFromParent[0].appendChild(nodeFromParent[2])\n        //     nodeFromParent[0].appendChild(nodeFromParent[1])\n        //     left.appendChild(nodeFromParent[0])\n        //     console.log(el)\n        //     node_childes.classList.add(\"margin-auto\")\n        //   } else {\n        //     let child_node = makeFromChild(el, node_text, rap_node, node_childes, text)\n        //     console.log(\"child_node\", child_node)\n        //     child_node.classList.add(\"node_childes\")\n        //     // child_node.classList.add(\"node_childes\")\n        //     // child_node.classList.add(\"margin-auto\")\n        //   }\n        // }\n\n\n        document.getElementById(`${'node' + el['id']}`).addEventListener('keydown', keydown_node);\n        document.getElementById(`${'node' + el['id']}`).addEventListener('keyup', keyup_node);\n      });\n      makelines();\n    });\n    return {\n      title,\n      nodes,\n      lines,\n      line_reset,\n      input_title,\n      keydown_node,\n      keyup_node\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["onMounted","ref","dragscroll","name","props","directives","setup","title","nodes","lines","count","LeaderLine","window","makeFromParent","d","el","node_text","rap_node","node_childes","text","classList","add","id","appendChild","makeFromChild","parent","document","getElementById","console","log","makelines","value","forEach","line","pointAnchor","x","y","path","endPlug","push","removelines","remove","length","line_reset","input_title","e","srcElement","innerText","keydown_node","keyup_node","Number","replace","scrollIntoView","block","inline","right","left","createElement","createTextNode","contentEditable","nodeFromParent","direction","child_node","addEventListener"],"sourceRoot":"","sources":["C:\\Users\\tnazu\\OneDrive\\ドキュメント\\coding\\vue3\\mindmap\\src\\components\\MindMap.vue"],"sourcesContent":["<template>\r\n  <div class=\"\">\r\n    <div class=\"edge\" @scroll=\"line_reset\" v-dragscroll=\"true\">\r\n      <div class=\"field\" id=\"field\">\r\n        <!-- <button class=\"btn\" @click=\"click()\">center</button> -->\r\n        <div class=\"left\">\r\n          <div class=\"left_vertical\">\r\n            <div class=\"left_horizontal\" id=\"left_center\">\r\n              <div></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"center\">\r\n          <div class=\"title_node_rap\">\r\n            <div class=\"title_nodes\" id=\"0\" contenteditable=\"true\" @:keydown=\"input_title($event)\">\r\n              <!-- @:keydown.tab=\"push_tab($el)\" -->\r\n              {{ title }}\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div class=\"right\">\r\n          <div class=\"right_vertical\">\r\n            <div class=\"right_horizontal\" id=\"right_center\">\r\n              <div></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  onMounted,\r\n  ref,\r\n\r\n} from \"vue\"\r\nimport { dragscroll } from 'vue-dragscroll'\r\n\r\nexport default {\r\n  name: 'MindMap',\r\n  props: {\r\n  },\r\n  directives: {\r\n    dragscroll\r\n  },\r\n  setup() {\r\n    let title = ref(\"title\")\r\n    let nodes = ref([\r\n      {\r\n        \"id\": 1,\r\n        'text': 'ch1',\r\n        'url': '',\r\n        'parent': 0,\r\n        'direction':''\r\n      },\r\n      {\r\n        \"id\": 2,\r\n        'text': 'ch2',\r\n        'url': '',\r\n        'parent': 0,\r\n        'direction':''\r\n      },\r\n      {\r\n        \"id\": 3,\r\n        'text': 'ch3',\r\n        'url': '',\r\n        'parent': 1,\r\n        'direction':''\r\n      },\r\n      {\r\n        \"id\": 4,\r\n        'text': 'ch4',\r\n        'url': '',\r\n        'parent': 1,\r\n        'direction':''\r\n      },\r\n      {\r\n        \"id\": 5,\r\n        'text': 'ch5',\r\n        'url': '',\r\n        'parent': 2,\r\n        'direction':''\r\n      },\r\n      {\r\n        \"id\": 6,\r\n        'text': 'ch6',\r\n        'url': '',\r\n        'parent': 2,\r\n        'direction':''\r\n      },\r\n      {\r\n        \"id\": 7,\r\n        'text': 'ch7',\r\n        'url': '',\r\n        'parent': 0,\r\n        'direction':''\r\n      },\r\n      {\r\n        \"id\": 8,\r\n        'text': 'ch8',\r\n        'url': '',\r\n        'parent': 0,\r\n        'direction':''\r\n      },\r\n    ]);\r\n    let lines = ref([\r\n\r\n    ])\r\n    let count = 0\r\n    const LeaderLine = window.LeaderLine;\r\n\r\n    // 9/27 fix input and move node\r\n\r\n    const makeFromParent = (d, el, node_text, rap_node, node_childes, text) => {\r\n      node_text.classList.add(\"p_nodes\");\r\n      rap_node.classList.add(\"rap_node\");\r\n      node_childes.classList.add(\"node_childes\");\r\n      node_childes.id = `${el[\"id\"]}`\r\n      node_text.id = `${\"node\" + el[\"id\"]}`\r\n      node_text.appendChild(text)\r\n\r\n      count++\r\n\r\n      return [rap_node, node_text, node_childes]\r\n    }\r\n\r\n    const makeFromChild = (el, node_text, rap_node, node_childes, text) => {\r\n      // console.log(\"child\", el)\r\n      const parent = document.getElementById(`${el[\"parent\"]}`)\r\n\r\n      console.log(parent)\r\n\r\n      node_text.classList.add(\"c_nodes\");\r\n      rap_node.classList.add(\"rap_node\");\r\n      node_childes.id = `${el[\"id\"]}`\r\n      node_text.id = `${\"node\" + el[\"id\"]}`\r\n      node_childes.classList.add(\"node_childes\");\r\n      node_text.appendChild(text)\r\n      rap_node.appendChild(node_childes)\r\n      rap_node.appendChild(node_text)\r\n      parent.appendChild(rap_node)\r\n      return node_childes\r\n    }\r\n\r\n    const makelines = () => {\r\n      nodes.value.forEach(el => {\r\n        if (el.parent == 0) {\r\n          let line = new LeaderLine(\r\n            document.getElementById('0'),\r\n            LeaderLine.pointAnchor(document.getElementById(`${\"node\" + el[\"id\"]}`), { x: '20%', y: '50%' })\r\n          );\r\n          // line.setOptions({startSocket: 'auto', endSocket: 'auto'});\r\n          line.path = \"magnet\"\r\n          line.endPlug = \"behind\"\r\n          lines.value.push(line)\r\n        } else {\r\n          let line = new LeaderLine(\r\n            document.getElementById(`${\"node\" + el[\"parent\"]}`),\r\n            LeaderLine.pointAnchor(document.getElementById(`${\"node\" + el[\"id\"]}`), { x: '20%', y: '50%' })\r\n          );\r\n          line.path = \"magnet\"\r\n          line.endPlug = \"behind\"\r\n          lines.value.push(line)\r\n        }\r\n      })\r\n    }\r\n\r\n    const removelines = () => {\r\n      lines.value.forEach(el => {\r\n        el.remove()\r\n      })\r\n      lines.value.length = 0\r\n    }\r\n\r\n    const line_reset = () => {\r\n      removelines()\r\n      makelines()\r\n    }\r\n\r\n    const input_title = (e) => {\r\n      // console.log(e.srcElement.innerText)\r\n      title.value = e.srcElement.innerText\r\n      console.log(title)\r\n      line_reset()\r\n    }\r\n\r\n    const keydown_node = (e) => {\r\n      // console.log(e)\r\n      e\r\n      // console.log(e.srcElement.innerText)\r\n      // console.log('before',e.target.offsetWidth)\r\n      // 横幅を動的に変更する\r\n      line_reset()\r\n    }\r\n\r\n    const keyup_node = (e) => {\r\n      // console.log('after',e.target.offsetWidth)\r\n      let id = Number(e.srcElement.id.replace(\"node\", \"\"))\r\n      // console.log(e.srcElement.innerText)\r\n      // console.log(nodes.value[id - 1].text)\r\n      nodes.value[id - 1].text = e.srcElement.innerText\r\n\r\n      console.log()\r\n\r\n      line_reset()\r\n    }\r\n\r\n    onMounted(() => {\r\n      console.log(\"mounted\")\r\n\r\n      document.getElementById('0').scrollIntoView({ block: 'center', inline: 'center', })\r\n\r\n      const right = document.getElementById(\"right_center\");\r\n      const left = document.getElementById(\"left_center\");\r\n\r\n      nodes.value.forEach(el => {\r\n        const node_text = document.createElement(\"div\");\r\n        const rap_node = document.createElement(\"div\");\r\n        const node_childes = document.createElement(\"div\");\r\n        const text = document.createTextNode(el[\"text\"]);\r\n        node_text.contentEditable = true;\r\n\r\n        if (el[\"parent\"] == 0) {\r\n          console.log()\r\n          if (count % 2 == 0) {\r\n            let nodeFromParent = makeFromParent(right, el, node_text, rap_node, node_childes, text)\r\n\r\n            nodeFromParent[0].appendChild(nodeFromParent[1])\r\n            nodeFromParent[0].appendChild(nodeFromParent[2])\r\n\r\n            right.appendChild(nodeFromParent[0])\r\n            console.log('el',el.direction)\r\n            el.direction = 'right'\r\n          } else {\r\n            let nodeFromParent = makeFromParent(right, el, node_text, rap_node, node_childes, text)\r\n\r\n            nodeFromParent[0].appendChild(nodeFromParent[2])\r\n            nodeFromParent[0].appendChild(nodeFromParent[1])\r\n\r\n            left.appendChild(nodeFromParent[0])\r\n            node_childes.classList.add(\"margin-auto\")\r\n            el.direction = 'left'\r\n          }\r\n        } else {\r\n          let child_node = makeFromChild(el, node_text, rap_node, node_childes, text)\r\n  \r\n          console.log(\"child_node!!!!!!!!!!\", el)\r\n\r\n          console.log(nodes.value[el.parent - 1].direction)\r\n          el.direction = nodes.value[el.parent - 1].direction\r\n          if(el.direction == 'right'){\r\n            child_node.classList.add(\"right_node_childes\")\r\n          }else{\r\n            child_node.classList.add(\"left_node_childes\")\r\n          }\r\n        }\r\n\r\n        // console.log(nodes.value)\r\n\r\n        // if (count % 2 == 0) {\r\n        //   if (el[\"parent\"] == 0) {\r\n        //     let nodeFromParent = makeFromParent(right, el, node_text, rap_node, node_childes, text)\r\n\r\n        //     nodeFromParent[0].appendChild(nodeFromParent[1])\r\n        //     nodeFromParent[0].appendChild(nodeFromParent[2])\r\n\r\n        //     right.appendChild(nodeFromParent[0])\r\n        //   } else {\r\n        //     let child_node = makeFromChild(el, node_text, rap_node, node_childes, text)\r\n        //     child_node.classList.add(\"node_childes\")\r\n        //     console.log(\"child_node!!!!!!!!!!\", child_node)\r\n        //   }\r\n        // } else {\r\n        //   if (el[\"parent\"] == 0) {\r\n        //     let nodeFromParent = makeFromParent(right, el, node_text, rap_node, node_childes, text)\r\n\r\n        //     nodeFromParent[0].appendChild(nodeFromParent[2])\r\n        //     nodeFromParent[0].appendChild(nodeFromParent[1])\r\n\r\n        //     left.appendChild(nodeFromParent[0])\r\n        //     console.log(el)\r\n        //     node_childes.classList.add(\"margin-auto\")\r\n        //   } else {\r\n        //     let child_node = makeFromChild(el, node_text, rap_node, node_childes, text)\r\n        //     console.log(\"child_node\", child_node)\r\n        //     child_node.classList.add(\"node_childes\")\r\n        //     // child_node.classList.add(\"node_childes\")\r\n        //     // child_node.classList.add(\"margin-auto\")\r\n        //   }\r\n        // }\r\n\r\n        document.getElementById(`${'node' + el['id']}`).addEventListener('keydown', keydown_node);\r\n        document.getElementById(`${'node' + el['id']}`).addEventListener('keyup', keyup_node);\r\n      });\r\n\r\n      makelines()\r\n    });\r\n\r\n    return {\r\n      title,\r\n      nodes,\r\n      lines,\r\n      line_reset,\r\n      input_title,\r\n      keydown_node,\r\n      keyup_node\r\n    };\r\n\r\n  },\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style>\r\n.btn {\r\n  z-index: 10000;\r\n  /* display: flex; */\r\n}\r\n\r\n.edge {\r\n  width: 900px;\r\n  height: 900px;\r\n  overflow: hidden;\r\n  border: 1px solid #000;\r\n}\r\n\r\n.field {\r\n  width: 1500px;\r\n  height: 1500px;\r\n  z-index: 1000000;\r\n  display: flex;\r\n  position: relative;\r\n}\r\n\r\n.center {\r\n  width: 30%;\r\n  height: 100%;\r\n  z-index: 1000000000000;\r\n  /* background-color: coral; */\r\n}\r\n\r\n.right {\r\n  width: 35%;\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.right_vertical {\r\n  width: 100%;\r\n  /* background-color: olive; */\r\n  margin: 0 auto;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n}\r\n\r\n.right_horizontal {\r\n  width: fit-content;\r\n  /* background-color: orchid; */\r\n}\r\n\r\n.left {\r\n  width: 35%;\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.left_vertical {\r\n  width: 100%;\r\n  margin: 0 auto;\r\n  text-align: left;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  /* background-color: olive; */\r\n}\r\n\r\n.left_horizontal {\r\n  width: fit-content;\r\n  /* background-color: orchid; */\r\n}\r\n\r\n.title_node_rap {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  width: 100%;\r\n  height: 100%;\r\n  margin: auto;\r\n}\r\n\r\n.title_nodes {\r\n  border-radius: 10px;\r\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, .5);\r\n  width: fit-content;\r\n  font-size: 35px;\r\n  font-family: sans-serif;\r\n  padding: 10px 10px;\r\n  background-color: #F5F5F5;\r\n  max-width: 200px;\r\n}\r\n\r\n.rap_node {\r\n  display: flex;\r\n  margin: 60px 0px;\r\n  align-items: center;\r\n  /* background-color: rebeccapurple; */\r\n}\r\n\r\n.p_nodes {\r\n  background-color: #F5F5F5;\r\n  border-radius: 10px;\r\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, .5);\r\n  /* width: fit-content;\r\n  height: fit-content; */\r\n  width: -moz-fit-content;\r\n  /* Firefox */\r\n  width: fit-content;\r\n  /* other browsers */\r\n  font-size: 23px;\r\n  padding: 10px 10px;\r\n  font-family: sans-serif;\r\n  margin: auto 0;\r\n}\r\n\r\n.c_nodes {\r\n  background-color: #F5F5F5;\r\n  border-radius: 10px;\r\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, .5);\r\n  /* width: fit-content;\r\n  height: fit-content; */\r\n  width: -moz-fit-content;\r\n  /* Firefox */\r\n  width: fit-content;\r\n  /* other browsers */\r\n  font-size: 23px;\r\n  padding: 10px 10px;\r\n  font-family: sans-serif;\r\n  margin: 60px 60px;\r\n}\r\n\r\n.right_node_childes {\r\n  width: 100%;\r\n  height: 100%;\r\n  /* background-color: brown; */\r\n  width: -moz-fit-content;\r\n  /* Firefox */\r\n  width: fit-content;\r\n  /* other browsers */\r\n}\r\n\r\n.left_node_childes {\r\n  width: 100%;\r\n  height: 100%;\r\n  width: -moz-fit-content;\r\n  width: fit-content;\r\n  margin-right: auto;\r\n}\r\n\r\n.margin-auto {\r\n  margin: auto;\r\n}\r\n\r\n#line {\r\n  position: absolute;\r\n  left: 100px;\r\n  top: 100px;\r\n  width: 200px;\r\n  height: 1px;\r\n  background-color: red;\r\n  transform-origin: left top;\r\n  transform: skewY(45deg);\r\n}\r\n</style>\r\n  \r\n"]},"metadata":{},"sourceType":"module"}